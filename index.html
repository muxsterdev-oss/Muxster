<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Muxster Social</title>
  <!-- Tailwind CSS CDN for styling -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- React and ReactDOM CDNs -->
  <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
  <!-- Babel for JSX compilation -->
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <style>
    body {
      padding-bottom: 72px; /* Adjust for the bottom nav bar on mobile */
    }
    @media (min-width: 640px) {
      body {
        padding-bottom: 0;
      }
    }
  </style>
  <script>
    tailwind.config = {
      darkMode: 'class',
      theme: {
        extend: {
          colors: {
            'monad-purple': '#6e54ff',
            'monad-blue': '#6e54ff',
            'monad-accent': '#6EE7B7',
            'monad-light': '#FFFFFF',
            'monad-dark': '#0D0E1F',
            'monad-dark-card': '#200052',
            'monad-dark-text': '#E5E7EB',
          }
        }
      }
    }
  </script>
</head>
<body class="bg-monad-dark font-sans dark:bg-monad-light">
  <div id="root"></div>

  <!-- The main application code using JSX -->
  <script type="text/babel">
    const { useState, useEffect } = React;
    const { createRoot } = ReactDOM;

    // Use inline SVGs for icons for a clean look.
    const ProfileIcon = ({ size = 24, className = "" }) => (
      <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={`lucide lucide-user-circle ${className}`}>
        <circle cx="12" cy="12" r="10" />
        <circle cx="12" cy="10" r="3" />
        <path d="M7 20.662V19a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v1.662" />
      </svg>
    );

    const HomeIcon = ({ size = 24, className = "" }) => (
      <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={`lucide lucide-home ${className}`}>
        <path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z" />
        <polyline points="9 22 9 12 15 12 15 22" />
      </svg>
    );
    
    const BellIcon = ({ size = 24, className = "" }) => (
      <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={`lucide lucide-bell ${className}`}>
        <path d="M6 8a6 6 0 0 1 12 0c0 7-3 9-3 9H9s-3-2-3-9" />
        <path d="M10.3 21a1.94 1.94 0 0 0 3.4 0" />
      </svg>
    );
    
    const RocketIcon = ({ size = 24, className = "" }) => (
      <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={`lucide lucide-rocket ${className}`}>
        <path d="M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z" />
        <path d="m14 14l7-7" />
        <path d="m17 11l5 5a2 2 0 0 1 0 2.82l-2.82 2.82a2 2 0 0 1-2.82 0l-5-5" />
        <path d="m5 5 5 5" />
        <path d="m14 14 5 5" />
      </svg>
    );

    const SettingsIcon = ({ size = 24, className = "" }) => (
      <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={`lucide lucide-settings ${className}`}>
        <path d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.39a2 2 0 0 0 .73 2.73l.15.08a2 2 0 0 1 1 1.73v.52a2 2 0 0 1-1 1.73l-.15.08a2 2 0 0 0-.73 2.73l.22.39a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.73v-.52a2 2 0 0 1 1-1.73l.15-.08a2 2 0 0 0 .73-2.73l-.22-.39a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2-0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z" />
        <circle cx="12" cy="12" r="3" />
      </svg>
    );

    const DevIcon = ({ size = 24, className = "" }) => (
      <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={`lucide lucide-code ${className}`}>
        <polyline points="16 18 22 12 16 6" />
        <polyline points="8 6 2 12 8 18" />
      </svg>
    );

    const SearchIcon = ({ size = 24, className = "" }) => (
      <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={`lucide lucide-search ${className}`}>
        <circle cx="11" cy="11" r="8" />
        <path d="m21 21-4.3-4.3" />
      </svg>
    );
    
    const SendIcon = () => (
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="lucide lucide-send">
        <path d="m22 2-7 20-4-9-9-4 20-7z" />
        <path d="M22 2 11 13" />
      </svg>
    );

    const HeartIcon = () => (
      <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="lucide lucide-heart">
        <path d="M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z" />
      </svg>
    );

    const MessageCircleIcon = () => (
      <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="lucide lucide-message-circle">
        <path d="M7.9 20A9.3 9.3 0 0 1 4 16.1L2 22l6-2h-2zm12.1-13A9.3 9.3 0 0 1 20 16.1L22 22l-6-2-2-2h2zm-12-13A9.3 9.3 0 0 1 4 8.1L2 14l6-2-2-2h2z" />
      </svg>
    );

    const ShareIcon = () => (
      <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="lucide lucide-share-2">
        <circle cx="18" cy="5" r="3" />
        <circle cx="6" cy="12" r="3" />
        <circle cx="18" cy="19" r="3" />
        <line x1="8.59" x2="15.42" y1="13.51" y2="17.49" />
        <line x1="15.41" x2="8.59" y1="6.51" y2="10.49" />
      </svg>
    );

    const CloseIcon = ({ size = 24, className = "" }) => (
      <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={`lucide lucide-x ${className}`}>
        <path d="M18 6 6 18" />
        <path d="m6 6 12 12" />
      </svg>
    );

    const SunIcon = ({ size = 24, className = "" }) => (
      <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={`lucide lucide-sun ${className}`}>
        <circle cx="12" cy="12" r="4" />
        <path d="M12 2v2" />
        <path d="M12 20v2" />
        <path d="m4.93 4.93 1.41 1.41" />
        <path d="m17.66 17.66 1.41 1.41" />
        <path d="M2 12h2" />
        <path d="M20 12h2" />
        <path d="m6.34 17.66-1.41 1.41" />
        <path d="m19.07 4.93-1.41 1.41" />
      </svg>
    );

    const MoonIcon = ({ size = 24, className = "" }) => (
      <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={`lucide lucide-moon ${className}`}>
        <path d="M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z" />
      </svg>
    );

    const SparklesIcon = ({ size = 20, className = "" }) => (
      <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={`lucide lucide-sparkles ${className}`}>
        <path d="M9.9 2.5A4.95 4.95 0 0 1 12 2a4.95 4.95 0 0 1 2.1.5l.8 1.1c.3.5.8.7 1.3.6a5.05 5.05 0 0 1 3.5 3.5c.1.5.3 1 .6 1.3l1.1.8c.8.6 1.1 1.4 1.1 2.1s-.3 1.5-.9 2.1l-1.1.8c-.5.3-.7.8-.6 1.3a5.05 5.05 0 0 1-3.5 3.5c-.5.1-1 .3-1.3.6l-.8 1.1c-.6.8-1.4 1.1-2.1 1.1s-1.5-.3-2.1-.9l-.8-1.1c-.3-.5-.8-.7-1.3-.6a5.05 5.05 0 0 1-3.5-3.5c-.1-.5-.3-1-.6-1.3l-1.1-.8c-.8-.6-1.1-1.4-1.1-2.1s.3-1.5.9-2.1l1.1-.8c.5-.3.7-.8.6-1.3a5.05 5.05 0 0 1 3.5-3.5c.5-.1 1-.3 1.3-.6l.8-1.1z" />
      </svg>
    );
    
    // A simple hook to manage state
    function useSocialPlatformState() {
      // Load initial state from local storage or use defaults
      const getInitialState = () => {
        const storedState = localStorage.getItem('muxsterState');
        if (storedState) {
          try {
            const state = JSON.parse(storedState);
            state.following = new Set(state.following);
            return state;
          } catch (e) {
            console.error("Failed to parse state from local storage:", e);
            localStorage.removeItem('muxsterState');
          }
        }
        return {
          casts: [
            { id: 1, author: '0x123...abc', content: 'Hello Muxster testnet! This is my first cast. Excited to build here!', timestamp: Date.now() - 3600000, likes: 12, replies: 3 },
            { id: 2, author: '0xdef...xyz', content: 'Muxster is an amazing L1! The dev experience is fantastic. #blockchain #monad', timestamp: Date.now() - 7200000, likes: 25, replies: 5 },
            { id: 3, author: '0x123...abc', content: 'A long post that might need to be summarized by Gemini. It contains some technical details about parallel execution and optimistic finality. This could be useful for other developers who are interested in learning about the Monad architecture and its benefits.', timestamp: Date.now() - 10800000, likes: 5, replies: 1 }
          ],
          newCastContent: '',
          walletAddress: null,
          userRole: null,
          myProfile: null,
          isProfileSetupComplete: false,
          projects: [
            { id: 1, name: 'Monad NFT Project', description: 'A collection of unique pixel art NFTs for the Monad ecosystem.', raised: 50, goal: 100, creator: '0xabc...123' },
            { id: 2, name: 'DeFi Lending Protocol', description: 'A new decentralized lending and borrowing protocol with low fees.', raised: 150, goal: 200, creator: '0xdef...456' },
          ],
          following: new Set(),
        };
      };

      const [state, setState] = useState(getInitialState());
      const [isLoading, setIsLoading] = useState(false);
      const [error, setError] = useState(null);
      const [currentPage, setCurrentPage] = useState('feed');
      const [currentProfileAddress, setCurrentProfileAddress] = useState(null);
      const [showFundingModal, setShowFundingModal] = useState(false);
      const [selectedProject, setSelectedProject] = useState(null);
      const [isAddingProject, setIsAddingProject] = useState(false);
      const [showRegistrationModal, setShowRegistrationModal] = useState(false);
      const [theme, setTheme] = useState('dark');
      const [summaries, setSummaries] = useState({});

      // Save state to local storage on every change
      useEffect(() => {
        try {
          const stateToSave = { ...state, following: Array.from(state.following) };
          localStorage.setItem('muxsterState', JSON.stringify(stateToSave));
        } catch (e) {
          console.error("Failed to save state to local storage:", e);
        }
      }, [state]);

      const toggleTheme = () => {
        const newTheme = theme === 'dark' ? 'light' : 'dark';
        setTheme(newTheme);
        document.documentElement.className = newTheme;
      };

      const startRegistration = () => {
        setShowRegistrationModal(true);
      };

      const completeRegistration = async (role) => {
        setIsLoading(true);
        setError(null);
        try {
          await new Promise(resolve => setTimeout(resolve, 1500));
          const mockAddress = '0x43525287f62e847c231785f7f2b1c43b023e120f';
          
          setState(prev => ({
            ...prev,
            walletAddress: mockAddress,
            userRole: role,
            currentProfileAddress: mockAddress,
            isProfileSetupComplete: false,
          }));
          setShowRegistrationModal(false);
        } catch (e) {
          setError('Failed to register. Please try again.');
        } finally {
          setIsLoading(false);
        }
      };

      const setupProfile = (profileData) => {
        const { displayName, username, bio, profilePic, banner } = profileData;
        setState(prev => ({
            ...prev,
            myProfile: {
                address: prev.walletAddress,
                role: prev.userRole,
                displayName,
                username,
                bio,
                profilePic: profilePic || `https://placehold.co/100x100/A78BFA/ffffff?text=${username.slice(0, 2).toUpperCase()}`,
                banner: banner || `https://placehold.co/600x200/4338CA/ffffff?text=Banner`,
                followers: 0,
                following: 0,
            },
            isProfileSetupComplete: true,
        }));
        setCurrentPage('feed');
      };
      
      const disconnectWallet = () => {
        setState(prev => ({
          ...prev,
          walletAddress: null,
          userRole: null,
          myProfile: null,
          currentProfileAddress: null,
          isProfileSetupComplete: false,
          following: new Set(),
        }));
        setCurrentPage('feed');
      };
      
      const updateProfile = (updatedProfile) => {
        setState(prev => ({ ...prev, myProfile: updatedProfile }));
      };
      
      const handleFollow = (address) => {
        setState(prev => {
          const isFollowing = prev.following.has(address);
          const newFollowing = new Set(prev.following);
          if (isFollowing) {
            newFollowing.delete(address);
          } else {
            newFollowing.add(address);
          }
          return {
            ...prev,
            following: newFollowing,
            myProfile: {
              ...prev.myProfile,
              following: isFollowing ? prev.myProfile.following - 1 : prev.myProfile.following + 1
            }
          };
        });
      };
      
      const handleLike = (castId) => {
        setState(prev => ({
          ...prev,
          casts: prev.casts.map(cast =>
            cast.id === castId ? { ...cast, likes: cast.likes + 1 } : cast
          )
        }));
      };
      
      const handleReply = (castId) => {
        setState(prev => ({
          ...prev,
          casts: prev.casts.map(cast =>
            cast.id === castId ? { ...cast, replies: cast.replies + 1 } : cast
          )
        }));
      };

      const publishNewCast = async (content) => {
        setIsLoading(true);
        setError(null);

        try {
          await new Promise(resolve => setTimeout(resolve, 2000));
          const newCast = {
            id: state.casts.length + 1,
            author: state.walletAddress,
            content,
            timestamp: Date.now(),
            likes: 0,
            replies: 0,
          };
          setState(prev => ({ ...prev, casts: [newCast, ...prev.casts], newCastContent: '' }));
        } catch (e) {
          setError('Failed to publish cast. Please check your wallet and try again.');
          console.error(e);
        } finally {
          setIsLoading(false);
        }
      };

      // Function to call Gemini API for summarization
      const summarizeCast = async (castId, content) => {
        setSummaries(prev => ({ ...prev, [castId]: { status: 'loading' } }));
        try {
          await new Promise(resolve => setTimeout(resolve, 1000));
          const summaryText = "This is a brief summary generated by a mock LLM. It highlights key points.";
          setSummaries(prev => ({ ...prev, [castId]: { status: 'success', text: summaryText } }));
        } catch (e) {
          console.error("Error summarizing cast:", e);
          setSummaries(prev => ({ ...prev, [castId]: { status: 'error', text: 'Failed to generate summary.' } }));
        }
      };

      const fundProject = async (projectId, amount) => {
        setIsLoading(true);
        setError(null);
        try {
          await new Promise(resolve => setTimeout(resolve, 2000));
          const updatedProjects = state.projects.map(proj => 
            proj.id === projectId ? { ...proj, raised: proj.raised + amount } : proj
          );
          setState(prev => ({ ...prev, projects: updatedProjects }));
          setShowFundingModal(false);
        } catch (e) {
          setError('Failed to fund project. Please try again.');
        } finally {
          setIsLoading(false);
        }
      };
      
      const addProject = (project) => {
        const newProject = {
          id: state.projects.length + 1,
          ...project,
          raised: 0,
          creator: state.walletAddress,
        };
        setState(prev => ({ ...prev, projects: [...prev.projects, newProject] }));
        setIsAddingProject(false);
      };

      return {
        ...state,
        newCastContent: state.newCastContent,
        setNewCastContent: content => setState(prev => ({...prev, newCastContent: content})),
        isLoading,
        setIsLoading,
        error,
        setError,
        publishNewCast,
        startRegistration,
        completeRegistration,
        disconnectWallet,
        updateProfile,
        currentPage,
        setCurrentPage,
        currentProfileAddress,
        setCurrentProfileAddress,
        fundProject,
        showFundingModal,
        setShowFundingModal,
        selectedProject,
        setSelectedProject,
        isAddingProject,
        setIsAddingProject,
        addProject,
        showRegistrationModal,
        setShowRegistrationModal,
        theme,
        toggleTheme,
        summaries,
        setSummaries,
        summarizeCast,
        handleFollow,
        handleLike,
        handleReply,
        setupProfile,
      };
    }

    const Cast = ({ id, author, content, timestamp, showProfile, myProfile, summaries, summarizeCast, handleLike, handleReply, likes, replies }) => {
      const isMyCast = myProfile && author === myProfile.address;
      const profilePic = isMyCast ? myProfile.profilePic : `https://placehold.co/100x100/${(author.slice(2, 8) + '000000').slice(0, 6)}/ffffff?text=${author.slice(2, 4)}`;
      const authorName = isMyCast ? myProfile.displayName : 'User';
      const authorUsername = isMyCast ? myProfile.username : author.substring(0, 6) + '...';
      const summary = summaries[id];

      return (
        <div className="flex space-x-4 p-4 border-b border-gray-700 dark:border-gray-300 hover:bg-gray-800 dark:hover:bg-gray-200 transition-colors duration-150">
          <div className="flex-shrink-0">
            <button onClick={() => showProfile(author)} className="block w-10 h-10 rounded-full overflow-hidden focus:outline-none focus:ring-2 focus:ring-monad-blue">
              <img src={profilePic} alt="Profile" className="w-full h-full object-cover"/>
            </button>
          </div>
          <div className="flex-grow">
            <div className="flex justify-between items-center text-sm text-gray-400 dark:text-gray-600">
              <button
                className="font-semibold text-monad-purple dark:text-monad-blue hover:underline cursor-pointer"
                onClick={() => showProfile(author)}
              >
                {authorName} <span className="font-mono text-xs text-gray-500 dark:text-gray-400">@{authorUsername}</span>
              </button>
              <span>{new Date(timestamp).toLocaleString()}</span>
            </div>
            <p className="mt-2 text-monad-dark-text dark:text-monad-dark leading-relaxed">{content}</p>
            {content.length > 50 && (
              <div className="mt-2">
                {summary && summary.status === 'loading' ? (
                  <div className="flex items-center space-x-2 text-monad-purple dark:text-monad-blue">
                    <div className="animate-spin rounded-full h-4 w-4 border-t-2 border-b-2 border-monad-blue"></div>
                    <p className="text-sm">Generating summary...</p>
                  </div>
                ) : summary && summary.status === 'success' ? (
                  <div className="bg-gray-700 dark:bg-gray-200 p-2 rounded-lg text-monad-dark-text dark:text-monad-dark text-sm">
                    âœ¨ {summary.text}
                  </div>
                ) : (
                  <button
                    onClick={() => summarizeCast(id, content)}
                    className="flex items-center space-x-1 text-sm text-monad-purple dark:text-monad-blue hover:underline transition-colors duration-150"
                  >
                    <SparklesIcon size={16}/>
                    <span>Summarize with Gemini</span>
                  </button>
                )}
              </div>
            )}
            <div className="flex space-x-6 mt-4 text-gray-500 dark:text-gray-500 text-sm">
              <button onClick={() => handleLike(id)} className="flex items-center space-x-1 hover:text-red-400 transition-colors duration-150">
                <HeartIcon />
                <span>{likes}</span>
              </button>
              <button onClick={() => handleReply(id)} className="flex items-center space-x-1 hover:text-cyan-400 transition-colors duration-150">
                <MessageCircleIcon />
                <span>{replies}</span>
              </button>
              <button className="flex items-center space-x-1 hover:text-emerald-400 transition-colors duration-150">
                <ShareIcon />
              </button>
            </div>
          </div>
        </div>
      );
    };

    const ProfilePage = ({ address, userRole, casts, myProfile, updateProfile, following, handleFollow }) => {
      const isMyProfile = myProfile && address === myProfile.address;
      const userCasts = casts.filter(cast => cast.author === address);
      const isFollowing = following.has(address);
      
      const [isEditing, setIsEditing] = useState(false);
      const [editForm, setEditForm] = useState(isMyProfile ? {
        displayName: myProfile.displayName,
        username: myProfile.username,
        bio: myProfile.bio,
        profilePic: myProfile.profilePic,
        banner: myProfile.banner,
      } : null);
      
      const handleEditChange = (e) => {
        const { name, value } = e.target;
        setEditForm(prev => ({ ...prev, [name]: value }));
      };
      
      const handleImageUpload = (e) => {
        const { name, files } = e.target;
        if (files.length > 0) {
          const file = files[0];
          const reader = new FileReader();
          reader.onloadend = () => {
            setEditForm(prev => ({ ...prev, [name]: reader.result }));
          };
          reader.readAsDataURL(file);
        }
      };

      const handleSave = () => {
        updateProfile({ ...myProfile, ...editForm });
        setIsEditing(false);
      };

      const userProfile = isMyProfile ? myProfile : {
        displayName: 'Guest User',
        username: address.substring(0, 6),
        bio: 'This is a public user profile on the Muxster social network.',
        profilePic: `https://placehold.co/100x100/${(address.slice(2, 8) + '000000').slice(0, 6)}/ffffff?text=${address.slice(2, 4)}`,
        banner: `https://placehold.co/600x200/${(address.slice(8, 14) + '000000').slice(0, 6)}/ffffff?text=Banner`
      };

      return (
        <div className="h-full">
          <div className="relative">
            <img src={isEditing ? editForm.banner : userProfile.banner} alt="User banner" className="w-full h-40 object-cover rounded-t-3xl"/>
            <div className="absolute -bottom-10 left-4">
              <img src={isEditing ? editForm.profilePic : userProfile.profilePic} alt="User profile" className="w-24 h-24 rounded-full border-4 border-monad-dark-card dark:border-monad-light shadow-lg"/>
            </div>
          </div>
          <div className="p-4 pt-16 sm:p-6">
            <div className="flex justify-end">
              {isMyProfile && !isEditing && (
                <button 
                  onClick={() => setIsEditing(true)}
                  className="bg-gray-600 dark:bg-gray-400 dark:text-monad-dark hover:bg-gray-500 text-white font-bold py-2 px-4 rounded-full transition-colors duration-200"
                >
                  Edit Profile
                </button>
              )}
              {!isMyProfile && (
                <button 
                  onClick={() => handleFollow(address)}
                  className={`font-bold py-2 px-4 rounded-full transition-colors duration-200 ${isFollowing ? 'bg-gray-600 dark:bg-gray-400 text-white dark:text-monad-dark' : 'bg-monad-accent hover:bg-emerald-600 text-monad-dark'}`}
                >
                  {isFollowing ? 'Following' : 'Follow'}
                </button>
              )}
            </div>
            
            {!isEditing ? (
              <>
                <h2 className="text-2xl font-bold text-monad-dark-text dark:text-monad-dark mt-4">{userProfile.displayName}</h2>
                <p className="text-sm text-gray-400 dark:text-gray-600 mt-1">@{userProfile.username}</p>
                <p className="text-sm text-gray-400 dark:text-gray-600 mt-1">
                  {address.substring(0, 6)}...{address.substring(address.length - 4)}
                </p>
                <p className="text-md text-gray-300 dark:text-gray-700 mt-4">{userProfile.bio}</p>
                <div className="flex space-x-6 mt-4 text-gray-400 dark:text-gray-600">
                    <span><span className="font-bold text-monad-dark-text dark:text-monad-dark">
                      {isMyProfile ? myProfile.followers : Math.floor(Math.random() * 1000) + 10}
                    </span> Followers</span>
                    <span><span className="font-bold text-monad-dark-text dark:text-monad-dark">
                      {isMyProfile ? myProfile.following : Math.floor(Math.random() * 500) + 5}
                    </span> Following</span>
                </div>
              </>
            ) : (
              <form className="mt-4 space-y-4">
                <label className="block text-sm font-medium text-gray-300 dark:text-gray-700">Display Name</label>
                <input
                  type="text"
                  name="displayName"
                  value={editForm.displayName}
                  onChange={handleEditChange}
                  className="w-full p-2 rounded-lg bg-gray-700 text-white dark:bg-gray-200 dark:text-monad-dark"
                  required
                />
                <label className="block text-sm font-medium text-gray-300 dark:text-gray-700">Username</label>
                <input
                  type="text"
                  name="username"
                  value={editForm.username}
                  onChange={handleEditChange}
                  className="w-full p-2 rounded-lg bg-gray-700 text-white dark:bg-gray-200 dark:text-monad-dark"
                  required
                />
                <label className="block text-sm font-medium text-gray-300 dark:text-gray-700">Bio</label>
                <textarea
                  name="bio"
                  value={editForm.bio}
                  onChange={handleEditChange}
                  rows="3"
                  className="w-full p-2 rounded-lg bg-gray-700 text-white dark:bg-gray-200 dark:text-monad-dark"
                />
                <label className="block text-sm font-medium text-gray-300 dark:text-gray-700">Profile Picture</label>
                <input
                  type="file"
                  name="profilePic"
                  onChange={handleImageUpload}
                  className="w-full p-2 rounded-lg bg-gray-700 text-white dark:bg-gray-200 dark:text-monad-dark file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-monad-blue file:text-white dark:file:bg-monad-purple dark:file:text-white hover:file:bg-indigo-600 dark:hover:file:bg-indigo-700"
                />
                <label className="block text-sm font-medium text-gray-300 dark:text-gray-700">Banner Picture</label>
                <input
                  type="file"
                  name="banner"
                  onChange={handleImageUpload}
                  className="w-full p-2 rounded-lg bg-gray-700 text-white dark:bg-gray-200 dark:text-monad-dark file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-monad-blue file:text-white dark:file:bg-monad-purple dark:file:text-white hover:file:bg-indigo-600 dark:hover:file:bg-indigo-700"
                />
                <div className="flex justify-end space-x-4">
                  <button
                    type="button"
                    onClick={() => setIsEditing(false)}
                    className="py-2 px-4 rounded-full text-white bg-gray-600 dark:bg-gray-400 dark:text-monad-dark hover:bg-gray-700 transition-colors duration-200"
                  >
                    Cancel
                  </button>
                  <button
                    type="button"
                    onClick={handleSave}
                    className="py-2 px-4 rounded-full text-white bg-monad-blue hover:bg-indigo-700 transition-colors duration-200"
                  >
                    Save
                  </button>
                </div>
              </form>
            )}
          </div>
          <div className="border-t border-gray-700 dark:border-gray-300 mt-4 p-4 sm:p-6">
            <h3 className="text-xl font-bold text-monad-dark-text dark:text-monad-dark mb-4">Casts</h3>
            <div className="space-y-4">
              {userCasts.length > 0 ? (
                userCasts.map((cast) => (
                  <div key={cast.id} className="bg-gray-700 dark:bg-gray-200 p-4 rounded-xl">
                    <p className="text-monad-dark-text dark:text-monad-dark leading-relaxed">{cast.content}</p>
                    <p className="text-sm text-gray-500 dark:text-gray-500 mt-2">
                      {new Date(cast.timestamp).toLocaleString()}
                    </p>
                  </div>
                ))
              ) : (
                <p className="text-center text-gray-400 dark:text-gray-600">No casts found for this user.</p>
              )}
            </div>
          </div>
        </div>
      );
    };

    const FeedPage = ({ casts, newCastContent, setNewCastContent, isLoading, error, publishNewCast, walletAddress, showProfile, myProfile, summaries, summarizeCast, handleLike, handleReply }) => {
      const handlePublish = (e) => {
        e.preventDefault();
        if (newCastContent.trim()) {
          publishNewCast(newCastContent);
        }
      };

      return (
        <>
          <div className="p-4 sm:p-6 border-b border-gray-700 dark:border-gray-300">
            {walletAddress ? (
              <form onSubmit={handlePublish} className="flex flex-col space-y-4">
                <textarea
                  className="w-full p-3 rounded-xl resize-none focus:outline-none focus:ring-2 focus:ring-monad-blue bg-gray-700 text-white dark:bg-gray-200 dark:text-monad-dark transition-all duration-200"
                  rows="3"
                  placeholder="What's on your mind? (140 characters max)"
                  value={newCastContent}
                  onChange={(e) => setNewCastContent(e.target.value)}
                  maxLength={140}
                  disabled={isLoading}
                />
                <div className="flex justify-between items-center">
                  <span className="text-sm text-gray-500 dark:text-gray-500">{newCastContent.length}/140</span>
                  <button
                    type="submit"
                    className="flex items-center space-x-2 bg-monad-blue hover:bg-monad-purple text-white font-bold py-2 px-5 rounded-full shadow-lg transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed"
                    disabled={isLoading || !newCastContent.trim()}
                  >
                    {isLoading ? 'Posting...' : (
                      <>
                        <span>Cast</span>
                        <SendIcon />
                      </>
                    )}
                  </button>
                </div>
              </form>
            ) : (
              <p className="text-center text-gray-400 dark:text-gray-600 py-4">Get started to begin casting!</p>
            )}
            {error && <p className="text-red-400 dark:text-red-500 text-center mt-4">{error}</p>}
          </div>

          <div className="pb-20">
            {casts.map((cast) => (
              <Cast key={cast.id} {...cast} showProfile={showProfile} myProfile={myProfile} summaries={summaries} summarizeCast={summarizeCast} handleLike={handleLike} handleReply={handleReply} />
            ))}
          </div>
        </>
      );
    };

    const NotificationsPage = () => (
      <div className="p-6">
        <h2 className="text-2xl font-bold mb-4 text-monad-dark-text dark:text-monad-dark">Notifications</h2>
        <div className="space-y-4">
          <div className="bg-gray-700 dark:bg-gray-200 p-4 rounded-xl flex items-center space-x-4">
            <BellIcon size={24} className="text-monad-purple dark:text-monad-blue" />
            <p className="text-monad-dark-text dark:text-monad-dark">User 0x123...abc liked your post!</p>
          </div>
          <div className="bg-gray-700 dark:bg-gray-200 p-4 rounded-xl flex items-center space-x-4">
            <ProfileIcon size={24} className="text-monad-purple dark:text-monad-blue" />
            <p className="text-monad-dark-text dark:text-monad-dark">User 0xdef...xyz is now following you.</p>
          </div>
          <div className="bg-gray-700 dark:bg-gray-200 p-4 rounded-xl flex items-center space-x-4">
            <RocketIcon size={24} className="text-monad-accent" />
            <p className="text-monad-dark-text dark:text-monad-dark">The "Monad NFT Project" has reached its funding goal!</p>
          </div>
        </div>
      </div>
    );

    const ExplorePage = ({ showProfile }) => {
      const [searchTerm, setSearchTerm] = useState('');
      
      const trendingTopics = ['#monad', '#defi', '#nft', '#buildonmonad'];
      const suggestedUsers = [
        { address: '0xabc...123', name: 'Dev Alpha' },
        { address: '0xdef...456', name: 'Builder Beta' },
      ];

      return (
        <div className="p-6">
          <h2 className="text-2xl font-bold mb-4 text-monad-dark-text dark:text-monad-dark">Explore</h2>
          <div className="mb-6">
            <input
              type="text"
              placeholder="Search Muxster"
              value={searchTerm}
              onChange={(e) => setSearchTerm(e.target.value)}
              className="w-full p-3 rounded-xl bg-gray-700 text-white dark:bg-gray-200 dark:text-monad-dark focus:outline-none focus:ring-2 focus:ring-monad-blue"
            />
          </div>
          <div className="mb-6">
            <h3 className="text-xl font-semibold mb-3 text-monad-dark-text dark:text-monad-dark">Trending</h3>
            <div className="flex flex-wrap gap-2">
              {trendingTopics.map(topic => (
                <button key={topic} className="bg-gray-700 dark:bg-gray-200 text-monad-purple dark:text-monad-blue text-sm font-semibold px-4 py-2 rounded-full hover:bg-gray-600 dark:hover:bg-gray-300 transition-colors duration-200">
                  {topic}
                </button>
              ))}
            </div>
          </div>
          <div>
            <h3 className="text-xl font-semibold mb-3 text-monad-dark-text dark:text-monad-dark">Suggested for you</h3>
            <div className="space-y-4">
              {suggestedUsers.map(user => (
                <div key={user.address} className="bg-gray-700 dark:bg-gray-200 p-3 rounded-xl flex items-center justify-between">
                  <div className="flex items-center space-x-3">
                    <img src={`https://placehold.co/50x50/${(user.address.slice(2, 8) + '000000').slice(0, 6)}/ffffff?text=${user.address.slice(2, 4)}`} alt="User profile" className="w-10 h-10 rounded-full" />
                    <div>
                      <p className="font-semibold text-monad-dark-text dark:text-monad-dark">{user.name}</p>
                      <p className="text-sm text-gray-400 dark:text-gray-600">@{user.address.substring(0, 6)}...</p>
                    </div>
                  </div>
                  <button onClick={() => showProfile(user.address)} className="bg-monad-accent hover:bg-emerald-600 text-monad-dark font-bold py-1 px-3 rounded-full transition-colors duration-200">
                    View Profile
                  </button>
                </div>
              ))}
            </div>
          </div>
        </div>
      );
    };
    
    // New components for the launchpad
    const FundingModal = ({ project, onFund, onClose }) => {
      const [amount, setAmount] = useState(0);

      const handleFund = () => {
        if (amount > 0) {
          onFund(project.id, amount);
        }
      };

      return (
        <div className="fixed inset-0 bg-gray-900 dark:bg-gray-100 bg-opacity-75 dark:bg-opacity-75 flex items-center justify-center p-4 z-50">
          <div className="bg-monad-dark-card dark:bg-white p-6 rounded-2xl shadow-2xl max-w-sm w-full">
            <h3 className="text-xl font-bold mb-4 text-monad-dark-text dark:text-monad-dark">Fund Project: {project.name}</h3>
            <p className="text-gray-400 dark:text-gray-600 mb-4">
              Current Goal: {project.raised} / {project.goal} MON
            </p>
            <label className="block mb-2 text-gray-300 dark:text-gray-700">Amount to fund (MON):</label>
            <input 
              type="number"
              value={amount}
              onChange={(e) => setAmount(parseInt(e.target.value) || 0)}
              className="w-full p-2 rounded-lg bg-gray-700 text-white dark:bg-gray-200 dark:text-monad-dark focus:outline-none focus:ring-2 focus:ring-monad-blue"
            />
            <div className="flex justify-end space-x-4 mt-6">
              <button 
                onClick={onClose}
                className="py-2 px-4 rounded-full text-white bg-gray-600 dark:bg-gray-400 dark:text-monad-dark hover:bg-gray-700 dark:hover:bg-gray-500 transition-colors duration-200"
              >
                Cancel
              </button>
              <button
                onClick={handleFund}
                className="py-2 px-4 rounded-full text-white bg-monad-blue hover:bg-monad-purple transition-colors duration-200 disabled:opacity-50"
                disabled={amount <= 0}
              >
                Fund
              </button>
            </div>
          </div>
        </div>
      );
    };

    const ProjectCard = ({ project, onFundClick }) => {
      const progress = Math.min(100, (project.raised / project.goal) * 100);
      return (
        <div className="bg-gray-700 dark:bg-gray-200 p-4 rounded-xl shadow-lg flex flex-col justify-between">
          <div>
            <h3 className="text-xl font-bold text-monad-purple dark:text-monad-blue">{project.name}</h3>
            <p className="text-sm text-gray-400 dark:text-gray-600 mt-1">{project.description}</p>
            <div className="mt-4">
              <div className="w-full bg-gray-600 dark:bg-gray-400 rounded-full h-2.5">
                <div 
                  className="bg-monad-accent h-2.5 rounded-full transition-all duration-500" 
                  style={{ width: `${progress}%` }}
                ></div>
              </div>
              <div className="flex justify-between text-sm mt-2 text-gray-400 dark:text-gray-600">
                <span>Raised: <span className="font-semibold text-monad-dark-text dark:text-monad-dark">{project.raised} MON</span></span>
                <span>Goal: <span className="font-semibold text-monad-dark-text dark:text-monad-dark">{project.goal} MON</span></span>
              </div>
            </div>
          </div>
          <button 
            onClick={() => onFundClick(project)}
            className="mt-4 bg-monad-blue hover:bg-monad-purple text-white font-bold py-2 px-4 rounded-full shadow-lg transition-colors duration-200"
          >
            Fund Project
          </button>
        </div>
      );
    };

    const NewProjectForm = ({ addProject, onCancel }) => {
      const [name, setName] = useState('');
      const [description, setDescription] = useState('');
      const [goal, setGoal] = useState('');

      const handleSubmit = (e) => {
        e.preventDefault();
        if (name && description && goal) {
          addProject({ name, description, goal: parseInt(goal) });
        }
      };

      return (
        <div className="p-4 bg-gray-700 dark:bg-gray-200 rounded-xl shadow-lg mt-6">
          <h3 className="text-xl font-bold text-monad-dark-text dark:text-monad-dark mb-4">Create a New Mux</h3>
          <form onSubmit={handleSubmit} className="space-y-4">
            <input 
              type="text" 
              placeholder="Mux Name" 
              value={name} 
              onChange={(e) => setName(e.target.value)}
              className="w-full p-3 rounded-lg bg-gray-800 text-white dark:bg-white dark:text-monad-dark focus:outline-none focus:ring-2 focus:ring-monad-blue"
              required
            />
            <textarea
              placeholder="Mux Description"
              value={description}
              onChange={(e) => setDescription(e.target.value)}
              className="w-full p-3 rounded-lg bg-gray-800 text-white dark:bg-white dark:text-monad-dark focus:outline-none focus:ring-2 focus:ring-monad-blue resize-none"
              rows="3"
              required
            />
            <input
              type="number"
              placeholder="Funding Goal (MON)"
              value={goal}
              onChange={(e) => setGoal(e.target.value)}
              className="w-full p-3 rounded-lg bg-gray-800 text-white dark:bg-white dark:text-monad-dark focus:outline-none focus:ring-2 focus:ring-monad-blue"
              required
            />
            <div className="flex justify-end space-x-4">
              <button 
                type="button" 
                onClick={onCancel}
                className="py-2 px-4 rounded-full text-white bg-gray-600 dark:bg-gray-400 dark:text-monad-dark hover:bg-gray-700 dark:hover:bg-gray-500 transition-colors duration-200"
              >
                Cancel
              </button>
              <button
                type="submit"
                className="py-2 px-4 rounded-full text-white bg-monad-blue hover:bg-monad-purple transition-colors duration-200"
              >
                Submit Mux
              </button>
            </div>
          </form>
        </div>
      );
    };

    const LaunchpadPage = ({ projects, fundProject, walletAddress, userRole, isLoading, showFundingModal, setShowFundingModal, selectedProject, setSelectedProject, isAddingProject, setIsAddingProject, addProject }) => {
      const handleFundClick = (project) => {
        if (walletAddress) {
          setSelectedProject(project);
          setShowFundingModal(true);
        } else {
          alert('Please get started to fund a project.');
        }
      };

      return (
        <div className="p-4 sm:p-6">
          <h2 className="text-2xl font-bold mb-4 text-monad-dark-text dark:text-monad-dark">Community Launchpad</h2>
          <p className="text-gray-400 dark:text-gray-600 mb-6">Support new projects on the Monad testnet!</p>
          
          {userRole === 'Muxer' && (
            isAddingProject ? (
              <NewProjectForm addProject={addProject} onCancel={() => setIsAddingProject(false)} />
            ) : (
              <button
                onClick={() => setIsAddingProject(true)}
                className="w-full mb-6 py-3 px-6 text-monad-dark font-bold bg-monad-accent hover:bg-emerald-600 rounded-full shadow-lg transition-colors duration-200"
              >
                Create New Mux
              </button>
            )
          )}

          <div className="grid grid-cols-1 sm:grid-cols-2 gap-6">
            {projects.map(project => (
              <ProjectCard 
                key={project.id}
                project={project}
                onFundClick={handleFundClick}
              />
            ))}
          </div>

          {showFundingModal && (
            <FundingModal 
              project={selectedProject}
              onFund={fundProject}
              onClose={() => setShowFundingModal(false)}
            />
          )}
        </div>
      );
    };

    const RegistrationModal = ({ completeRegistration, isLoading, onClose }) => (
      <div className="fixed inset-0 bg-gray-900 dark:bg-gray-100 bg-opacity-75 dark:bg-opacity-75 flex items-center justify-center p-4 z-50">
        <div className="bg-monad-dark-card dark:bg-white p-6 rounded-2xl shadow-2xl max-w-md w-full text-center">
          <button onClick={onClose} className="absolute top-4 right-4 text-gray-500 hover:text-white dark:hover:text-monad-dark"><CloseIcon /></button>
          <h3 className="text-2xl font-bold mb-4 text-monad-purple dark:text-monad-blue">Choose Your Role</h3>
          <p className="text-gray-300 dark:text-gray-700 mb-6">Connect your wallet and pick your path in the Muxster ecosystem.</p>
          <div className="grid grid-cols-1 sm:grid-cols-3 gap-4">
            <button
              onClick={() => completeRegistration('Muxster')}
              className="flex flex-col items-center p-6 bg-gray-700 dark:bg-gray-200 rounded-xl hover:bg-monad-blue transition-colors duration-200 disabled:opacity-50 text-monad-dark-text dark:text-monad-dark hover:text-white"
              disabled={isLoading}
            >
              <ProfileIcon size={48} className="text-white mb-2 dark:text-monad-dark" />
              <span className="text-lg font-semibold">Muxster</span>
              <span className="text-sm text-gray-400 dark:text-gray-600">Regular User</span>
            </button>
            <button
              onClick={() => completeRegistration('Muxer')}
              className="flex flex-col items-center p-6 bg-gray-700 dark:bg-gray-200 rounded-xl hover:bg-monad-blue transition-colors duration-200 disabled:opacity-50 text-monad-dark-text dark:text-monad-dark hover:text-white"
              disabled={isLoading}
            >
              <DevIcon size={48} className="text-white mb-2 dark:text-monad-dark" />
              <span className="text-lg font-semibold">Muxer</span>
              <span className="text-sm text-gray-400 dark:text-gray-600">Developer</span>
            </button>
            <button
              onClick={() => completeRegistration('Mux')}
              className="flex flex-col items-center p-6 bg-gray-700 dark:bg-gray-200 rounded-xl hover:bg-monad-blue transition-colors duration-200 disabled:opacity-50 text-monad-dark-text dark:text-monad-dark hover:text-white"
              disabled={isLoading}
            >
              <RocketIcon size={48} className="text-white mb-2 dark:text-monad-dark" />
              <span className="text-lg font-semibold">Mux</span>
              <span className="text-sm text-gray-400 dark:text-gray-600">Project</span>
            </button>
          </div>
          {isLoading && <p className="mt-4 text-monad-blue dark:text-monad-purple">Connecting...</p>}
        </div>
      </div>
    );
    
    // New modal for user profile setup
    const ProfileSetupModal = ({ walletAddress, userRole, setupProfile, isLoading }) => {
      const [editForm, setEditForm] = useState({
        displayName: userRole,
        username: userRole.toLowerCase() + '_user',
        bio: `Just a ${userRole.toLowerCase()} exploring the Monad ecosystem!`,
        profilePic: '',
        banner: '',
      });
    
      const handleEditChange = (e) => {
        const { name, value } = e.target;
        setEditForm(prev => ({ ...prev, [name]: value }));
      };
    
      const handleImageUpload = (e) => {
        const { name, files } = e.target;
        if (files.length > 0) {
          const file = files[0];
          const reader = new FileReader();
          reader.onloadend = () => {
            setEditForm(prev => ({ ...prev, [name]: reader.result }));
          };
          reader.readAsDataURL(file);
        }
      };

      const handleSubmit = (e) => {
        e.preventDefault();
        setupProfile(editForm);
      };
    
      return (
        <div className="fixed inset-0 bg-gray-900 dark:bg-gray-100 bg-opacity-75 dark:bg-opacity-75 flex items-center justify-center p-4 z-50 overflow-y-auto">
          <div className="bg-monad-dark-card dark:bg-white p-6 rounded-2xl shadow-2xl max-w-lg w-full my-8">
            <h3 className="text-2xl font-bold mb-4 text-monad-purple dark:text-monad-blue text-center">Set Up Your Muxster Profile</h3>
            <p className="text-gray-300 dark:text-gray-700 mb-6 text-center">Just a few more steps to get started!</p>
            
            <form onSubmit={handleSubmit} className="mt-4 space-y-4">
              <label className="block text-sm font-medium text-gray-300 dark:text-gray-700">Display Name</label>
              <input
                type="text"
                name="displayName"
                value={editForm.displayName}
                onChange={handleEditChange}
                className="w-full p-2 rounded-lg bg-gray-700 text-white dark:bg-gray-200 dark:text-monad-dark"
                required
              />
              <label className="block text-sm font-medium text-gray-300 dark:text-gray-700">Username</label>
              <input
                type="text"
                name="username"
                value={editForm.username}
                onChange={handleEditChange}
                className="w-full p-2 rounded-lg bg-gray-700 text-white dark:bg-gray-200 dark:text-monad-dark"
                required
              />
              <label className="block text-sm font-medium text-gray-300 dark:text-gray-700">Bio</label>
              <textarea
                name="bio"
                value={editForm.bio}
                onChange={handleEditChange}
                rows="3"
                className="w-full p-2 rounded-lg bg-gray-700 text-white dark:bg-gray-200 dark:text-monad-dark"
              />
              <div className="flex space-x-4">
                <div className="flex-1">
                  <label className="block text-sm font-medium text-gray-300 dark:text-gray-700 mb-2">Profile Picture</label>
                  <img
                    src={editForm.profilePic || `https://placehold.co/100x100/A78BFA/ffffff?text=PFP`}
                    alt="Profile preview"
                    className="w-24 h-24 rounded-full object-cover border-4 border-gray-600 dark:border-gray-300 mx-auto"
                  />
                  <input
                    type="file"
                    name="profilePic"
                    onChange={handleImageUpload}
                    className="w-full p-2 rounded-lg mt-2 bg-gray-700 text-white dark:bg-gray-200 dark:text-monad-dark file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-monad-blue file:text-white dark:file:bg-monad-purple dark:file:text-white hover:file:bg-indigo-600 dark:hover:file:bg-indigo-700"
                  />
                </div>
                <div className="flex-1">
                  <label className="block text-sm font-medium text-gray-300 dark:text-gray-700 mb-2">Banner Picture</label>
                  <img
                    src={editForm.banner || `https://placehold.co/200x80/4338CA/ffffff?text=Banner`}
                    alt="Banner preview"
                    className="w-full h-20 object-cover rounded-xl border-4 border-gray-600 dark:border-gray-300 mx-auto"
                  />
                  <input
                    type="file"
                    name="banner"
                    onChange={handleImageUpload}
                    className="w-full p-2 rounded-lg mt-2 bg-gray-700 text-white dark:bg-gray-200 dark:text-monad-dark file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-monad-blue file:text-white dark:file:bg-monad-purple dark:file:text-white hover:file:bg-indigo-600 dark:hover:file:bg-indigo-700"
                  />
                </div>
              </div>
              
              <div className="flex justify-end space-x-4 mt-6">
                <button
                  type="submit"
                  className="w-full py-3 px-4 rounded-full text-white font-bold bg-monad-blue hover:bg-monad-purple transition-colors duration-200"
                  disabled={isLoading}
                >
                  {isLoading ? 'Saving...' : 'Complete Profile'}
                </button>
              </div>
            </form>
          </div>
        </div>
      );
    };

    const SettingsPage = ({ disconnectWallet }) => (
      <div className="p-6 space-y-6">
        <h2 className="text-2xl font-bold text-monad-dark-text dark:text-monad-dark">Settings</h2>
        
        {/* Notifications Section */}
        <div className="bg-gray-700 dark:bg-gray-200 p-6 rounded-xl shadow-lg">
          <h3 className="text-xl font-bold mb-4 text-monad-dark-text dark:text-monad-dark">Notifications</h3>
          <div className="space-y-4 text-gray-300 dark:text-gray-700">
            <div className="flex items-center justify-between">
              <span>Push Notifications</span>
              <label htmlFor="push-toggle" className="relative inline-flex items-center cursor-pointer">
                <input type="checkbox" id="push-toggle" className="sr-only peer" />
                <div className="w-11 h-6 bg-gray-500 rounded-full peer-checked:bg-monad-purple after:absolute after:top-0.5 after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:after:translate-x-full"></div>
              </label>
            </div>
            <div className="flex items-center justify-between">
              <span>Email Notifications</span>
              <label htmlFor="email-toggle" className="relative inline-flex items-center cursor-pointer">
                <input type="checkbox" id="email-toggle" className="sr-only peer" />
                <div className="w-11 h-6 bg-gray-500 rounded-full peer-checked:bg-monad-purple after:absolute after:top-0.5 after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:after:translate-x-full"></div>
              </label>
            </div>
          </div>
        </div>

        {/* Privacy Section */}
        <div className="bg-gray-700 dark:bg-gray-200 p-6 rounded-xl shadow-lg">
          <h3 className="text-xl font-bold mb-4 text-monad-dark-text dark:text-monad-dark">Privacy</h3>
          <div className="space-y-4 text-gray-300 dark:text-gray-700">
            <div className="flex items-center justify-between">
              <span>Public Profile</span>
              <label htmlFor="public-profile-toggle" className="relative inline-flex items-center cursor-pointer">
                <input type="checkbox" id="public-profile-toggle" className="sr-only peer" defaultChecked />
                <div className="w-11 h-6 bg-gray-500 rounded-full peer-checked:bg-monad-purple after:absolute after:top-0.5 after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:after:translate-x-full"></div>
              </label>
            </div>
            <div className="flex items-center justify-between">
              <span>Allow DMs from anyone</span>
              <label htmlFor="dms-toggle" className="relative inline-flex items-center cursor-pointer">
                <input type="checkbox" id="dms-toggle" className="sr-only peer" />
                <div className="w-11 h-6 bg-gray-500 rounded-full peer-checked:bg-monad-purple after:absolute after:top-0.5 after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:after:translate-x-full"></div>
              </label>
            </div>
          </div>
        </div>

        {/* Security Section */}
        <div className="bg-gray-700 dark:bg-gray-200 p-6 rounded-xl shadow-lg">
          <h3 className="text-xl font-bold mb-4 text-monad-dark-text dark:text-monad-dark">Security</h3>
          <div className="space-y-4">
            <button className="w-full py-2 px-4 text-monad-dark-text dark:text-monad-dark font-bold bg-gray-600 dark:bg-gray-400 rounded-full hover:bg-gray-500 dark:hover:bg-gray-500 transition-colors duration-200">
              Change Password
            </button>
            <button className="w-full py-2 px-4 text-monad-dark-text dark:text-monad-dark font-bold bg-gray-600 dark:bg-gray-400 rounded-full hover:bg-gray-500 dark:hover:bg-gray-500 transition-colors duration-200">
              Enable 2FA
            </button>
          </div>
        </div>

        {/* Danger Zone */}
        <div className="bg-red-800 dark:bg-red-200 p-6 rounded-xl shadow-lg">
          <h3 className="text-xl font-bold mb-4 text-white dark:text-red-800">Danger Zone</h3>
          <p className="text-md text-red-100 dark:text-red-800 mb-4">You can disconnect your wallet here. This will log you out of the application.</p>
          <button
            onClick={disconnectWallet}
            className="w-full bg-red-600 hover:bg-red-700 text-white font-bold py-3 px-6 rounded-full shadow-lg transition-colors duration-200"
          >
            Disconnect Wallet
          </button>
        </div>
      </div>
    );
    
    // Main navigation component that is responsive
    const Navigation = ({ currentPage, setCurrentPage, walletAddress, showProfile, navItems }) => {
        const handleProfileClick = () => {
            if (walletAddress) {
                showProfile(walletAddress);
            }
        };

        return (
            <>
                {/* Desktop Sidebar */}
                <div className="hidden md:flex flex-col w-64 pr-8">
                    <div className="p-4 flex flex-col space-y-2">
                        <h1 className="text-3xl font-bold text-monad-purple dark:text-monad-blue">Muxster</h1>
                        {navItems.map(item => (
                            <button
                                key={item.id}
                                onClick={item.id === 'profile' ? handleProfileClick : () => setCurrentPage(item.id)}
                                className={`flex items-center space-x-3 p-3 rounded-xl transition-all duration-200 ${currentPage === item.id ? 'text-monad-purple dark:text-monad-blue bg-gray-800 dark:bg-gray-200' : 'text-gray-500 hover:text-monad-purple dark:hover:text-monad-blue'}`}
                                disabled={item.disabled}
                            >
                                <item.icon size={24} />
                                <span className="text-lg font-medium">{item.label}</span>
                            </button>
                        ))}
                    </div>
                </div>

                {/* Mobile Bottom Navigation Menu */}
                <div className="md:hidden fixed bottom-0 left-0 right-0 mx-auto bg-monad-dark dark:bg-monad-light border-t border-gray-700 dark:border-gray-300 p-2 rounded-t-3xl flex justify-around shadow-2xl z-20">
                    {navItems.map(item => (
                        <button
                            key={item.id}
                            onClick={item.id === 'profile' ? handleProfileClick : () => setCurrentPage(item.id)}
                            className={`flex flex-col items-center p-2 rounded-xl transition-all duration-200 ${currentPage === item.id ? 'text-monad-purple dark:text-monad-blue bg-gray-800 dark:bg-gray-200' : 'text-gray-500 hover:text-monad-purple dark:hover:text-monad-blue'}`}
                            disabled={item.disabled}
                        >
                            <item.icon size={28} />
                            <span className="text-xs font-medium mt-1">{item.label}</span>
                        </button>
                    ))}
                </div>
            </>
        );
    };
    
    const RightSidebar = ({ showProfile }) => {
      const trendingTopics = ['#monad', '#defi', '#buildonmonad', '#ai'];
      const newsEvents = [
        { id: 1, title: 'Monad Mainnet Launch Announced', summary: 'The highly anticipated Monad mainnet launch date has been revealed.' },
        { id: 2, title: 'DeFi Lending Protocol Gets a Boost', summary: 'A new lending protocol built on Monad receives significant funding.' },
      ];
      const suggestedUsers = [
        { address: '0xabc...123', name: 'Dev Alpha' },
        { address: '0xdef...456', name: 'Builder Beta' },
      ];
      
      return (
        <div className="hidden md:flex flex-col w-72 pl-8 space-y-6">
          <div className="bg-monad-dark-card dark:bg-white p-4 rounded-3xl shadow-xl">
            <h3 className="text-xl font-bold mb-3 text-monad-dark-text dark:text-monad-dark">Trending Topics</h3>
            <div className="flex flex-wrap gap-2">
              {trendingTopics.map(topic => (
                <button key={topic} className="bg-gray-700 dark:bg-gray-200 text-monad-purple dark:text-monad-blue text-sm font-semibold px-4 py-2 rounded-full hover:bg-gray-600 dark:hover:bg-gray-300 transition-colors duration-200">
                  {topic}
                </button>
              ))}
            </div>
          </div>
          <div className="bg-monad-dark-card dark:bg-white p-4 rounded-3xl shadow-xl">
            <h3 className="text-xl font-bold mb-3 text-monad-dark-text dark:text-monad-dark">News & Events</h3>
            <div className="space-y-4">
              {newsEvents.map(event => (
                <div key={event.id}>
                  <p className="font-semibold text-monad-dark-text dark:text-monad-dark">{event.title}</p>
                  <p className="text-sm text-gray-400 dark:text-gray-600">{event.summary}</p>
                </div>
              ))}
            </div>
          </div>
          <div className="bg-monad-dark-card dark:bg-white p-4 rounded-3xl shadow-xl">
            <h3 className="text-xl font-bold mb-3 text-monad-dark-text dark:text-monad-dark">Who to Follow</h3>
            <div className="space-y-4">
              {suggestedUsers.map(user => (
                <div key={user.address} className="bg-gray-700 dark:bg-gray-200 p-3 rounded-xl flex items-center justify-between">
                  <div className="flex items-center space-x-3">
                    <img src={`https://placehold.co/50x50/${(user.address.slice(2, 8) + '000000').slice(0, 6)}/ffffff?text=${user.address.slice(2, 4)}`} alt="User profile" className="w-10 h-10 rounded-full" />
                    <div>
                      <p className="font-semibold text-monad-dark-text dark:text-monad-dark">{user.name}</p>
                      <p className="text-sm text-gray-400 dark:text-gray-600">@{user.address.substring(0, 6)}...</p>
                    </div>
                  </div>
                  <button onClick={() => showProfile(user.address)} className="bg-monad-accent hover:bg-emerald-600 text-monad-dark font-bold py-1 px-3 rounded-full transition-colors duration-200">
                    View Profile
                  </button>
                </div>
              ))}
            </div>
          </div>
        </div>
      );
    };

    const navItems = [
      { id: 'feed', icon: HomeIcon, label: 'Timeline' },
      { id: 'explore', icon: SearchIcon, label: 'Explore' },
      { id: 'launchpad', icon: RocketIcon, label: 'Funding' },
      { id: 'notifications', icon: BellIcon, label: 'Notifications' },
      { id: 'profile', icon: ProfileIcon, label: 'Profile', disabled: false },
      { id: 'settings', icon: SettingsIcon, label: 'Settings' }
    ];

    const App = () => {
      const {
        casts,
        newCastContent,
        setNewCastContent,
        isLoading,
        error,
        publishNewCast,
        walletAddress,
        userRole,
        myProfile,
        startRegistration,
        completeRegistration,
        disconnectWallet,
        updateProfile,
        currentPage,
        setCurrentPage,
        currentProfileAddress,
        setCurrentProfileAddress,
        projects,
        fundProject,
        showFundingModal,
        setShowFundingModal,
        selectedProject,
        setSelectedProject,
        isAddingProject,
        setIsAddingProject,
        addProject,
        showRegistrationModal,
        setShowRegistrationModal,
        theme,
        toggleTheme,
        summaries,
        summarizeCast,
        following,
        handleFollow,
        handleLike,
        handleReply,
        isProfileSetupComplete,
        setupProfile,
      } = useSocialPlatformState();
      
      const showProfile = (address) => {
        setCurrentProfileAddress(address);
        setCurrentPage('profile');
      };

      const renderPage = () => {
        if (!isProfileSetupComplete && walletAddress) {
            return <ProfileSetupModal walletAddress={walletAddress} userRole={userRole} setupProfile={setupProfile} isLoading={isLoading} />;
        }
        
        switch (currentPage) {
          case 'feed':
            return (
              <FeedPage 
                casts={casts}
                newCastContent={newCastContent}
                setNewCastContent={setNewCastContent}
                isLoading={isLoading}
                error={error}
                publishNewCast={publishNewCast}
                walletAddress={walletAddress}
                showProfile={showProfile}
                myProfile={myProfile}
                summaries={summaries}
                summarizeCast={summarizeCast}
                handleLike={handleLike}
                handleReply={handleReply}
              />
            );
          case 'profile':
            const profileCasts = casts.filter(c => c.author === currentProfileAddress);
            return (
              <ProfilePage
                address={currentProfileAddress}
                userRole={userRole}
                myProfile={myProfile}
                casts={profileCasts}
                updateProfile={updateProfile}
                following={following}
                handleFollow={handleFollow}
              />
            );
          case 'notifications':
            return <NotificationsPage />;
          case 'explore':
            return <ExplorePage showProfile={showProfile} />;
          case 'launchpad':
            return (
              <LaunchpadPage
                projects={projects}
                fundProject={fundProject}
                walletAddress={walletAddress}
                userRole={userRole}
                isLoading={isLoading}
                showFundingModal={showFundingModal}
                setShowFundingModal={setShowFundingModal}
                selectedProject={selectedProject}
                setSelectedProject={setSelectedProject}
                isAddingProject={isAddingProject}
                setIsAddingProject={setIsAddingProject}
                addProject={addProject}
              />
            );
          case 'settings':
            return <SettingsPage disconnectWallet={disconnectWallet} />;
          default:
            return (
              <FeedPage 
                casts={casts}
                newCastContent={newCastContent}
                setNewCastContent={setNewCastContent}
                isLoading={isLoading}
                error={error}
                publishNewCast={publishNewCast}
                walletAddress={walletAddress}
                showProfile={showProfile}
                myProfile={myProfile}
                summaries={summaries}
                summarizeCast={summarizeCast}
                handleLike={handleLike}
                handleReply={handleReply}
              />
            );
        }
      };

      return (
        <div className="flex sm:justify-center p-4 sm:p-8 font-sans bg-monad-dark dark:bg-monad-light min-h-screen">
          <div className="flex w-full max-w-7xl">
            {/* Left Sidebar */}
            <div className="hidden md:flex flex-col w-64 pr-8">
              <div className="p-4 flex flex-col space-y-2">
                <h1 className="text-3xl font-bold text-monad-purple dark:text-monad-blue">Muxster</h1>
                {navItems.map(item => (
                    <button
                        key={item.id}
                        onClick={() => {
                            if (item.id === 'profile') {
                                if (walletAddress) {
                                    showProfile(walletAddress);
                                }
                            } else {
                                setCurrentPage(item.id);
                            }
                        }}
                        className={`flex items-center space-x-3 p-3 rounded-xl transition-all duration-200 ${currentPage === item.id ? 'text-monad-purple dark:text-monad-blue bg-gray-800 dark:bg-gray-200' : 'text-gray-500 hover:text-monad-purple dark:hover:text-monad-blue'}`}
                        disabled={item.disabled}
                    >
                        <item.icon size={24} />
                        <span className="text-lg font-medium">{item.label}</span>
                    </button>
                ))}
              </div>
            </div>
            
            {/* Main Content Pane */}
            <div className="w-full md:w-3/5 lg:w-3/5 bg-monad-dark-card dark:bg-white rounded-3xl shadow-2xl overflow-hidden flex flex-col relative">
              {/* Header for both desktop and mobile view */}
              <div className="p-4 sm:p-6 bg-monad-dark dark:bg-monad-light border-b border-gray-700 dark:border-gray-300 flex justify-between items-center z-20">
                <h1 className="text-2xl sm:text-3xl font-bold text-monad-purple dark:text-monad-blue md:hidden">Muxster Social</h1>
                <div className="flex-grow text-3xl font-bold pl-4 text-monad-purple dark:text-monad-blue hidden md:block">{navItems.find(item => item.id === currentPage)?.label}</div>
                <div className="flex items-center space-x-2">
                  <button
                    onClick={toggleTheme}
                    className="p-2 rounded-full text-gray-400 dark:text-gray-600 hover:text-white dark:hover:text-black transition-colors duration-200"
                  >
                    {theme === 'dark' ? <SunIcon /> : <MoonIcon />}
                  </button>
                  {!walletAddress && (
                    <button
                      onClick={startRegistration}
                      className="flex items-center space-x-2 bg-monad-blue hover:bg-monad-purple text-white font-bold py-2 px-4 rounded-full shadow-lg transition-colors duration-200"
                      disabled={isLoading}
                    >
                      {isLoading ? 'Loading...' : 'Get Started'}
                    </button>
                  )}
                </div>
              </div>

              {/* Main Content Area */}
              <div className="flex-grow overflow-y-auto pb-16 sm:pb-0">
                {renderPage()}
              </div>
              
              {/* Mobile Bottom Navigation Menu */}
              <div className="md:hidden fixed bottom-0 left-0 right-0 mx-auto bg-monad-dark dark:bg-monad-light border-t border-gray-700 dark:border-gray-300 p-2 rounded-t-3xl flex justify-around shadow-2xl z-20">
                {navItems.map(item => (
                    <button
                        key={item.id}
                        onClick={() => {
                            if (item.id === 'profile') {
                                if (walletAddress) {
                                    showProfile(walletAddress);
                                }
                            } else {
                                setCurrentPage(item.id);
                            }
                        }}
                        className={`flex flex-col items-center p-2 rounded-xl transition-all duration-200 ${currentPage === item.id ? 'text-monad-purple dark:text-monad-blue bg-gray-800 dark:bg-gray-200' : 'text-gray-500 hover:text-monad-purple dark:hover:text-monad-blue'}`}
                        disabled={item.disabled}
                    >
                        <item.icon size={28} />
                        <span className="text-xs font-medium mt-1">{item.label}</span>
                    </button>
                ))}
              </div>
            </div>

            <RightSidebar showProfile={showProfile} />
          </div>
          {showRegistrationModal && (
            <RegistrationModal
              completeRegistration={completeRegistration}
              isLoading={isLoading}
              onClose={() => setShowRegistrationModal(false)}
            />
          )}
          
          {walletAddress && !isProfileSetupComplete && userRole && (
            <ProfileSetupModal
                walletAddress={walletAddress}
                userRole={userRole}
                setupProfile={setupProfile}
                isLoading={isLoading}
            />
          )}
        </div>
      );
    };

    const container = document.getElementById('root');
    const root = createRoot(container);
    root.render(<App />);

  </script>
</body>
</html>
